# A SEMI-SUPERVISED AND EVASION-AWARE FRAMEWORK FOR REDUCING ALERT FATIGUE IN SECURITY OPERATIONS CENTRES

## ğŸ“Œ Project Overview

Modern Security Operations Centers (SOCs) face alert fatigue due to massive volumes of security events generated by SIEM systems. Manual triage is slow, inconsistent, and expensive. At the same time, high-quality labeled security data is scarce, making purely supervised models impractical in real environments.

This project presents an **AI-powered SOC automation framework** that integrates a Hybrid Semi-Supervised Learning (SSL) model with Wazuh SIEM to automatically classify, prioritize, and triage security alerts in near real-time.

Unlike offline detection systems, this project demonstrates a **working end-to-end SOC loop**:

```
Log â†’ Wazuh â†’ ML Model â†’ Triage Decision â†’ Wazuh Alert
```

![SOC Pipeline Flow]([PLACEHOLDER_FOR_FLOW_IMAGE])

## ğŸ¯ Objectives

The main goals of this project were:

- Reduce SOC alert overload by automatically triaging benign vs malicious alerts
- Leverage semi-supervised learning to overcome limited labeled data
- Detect evasive and novel attacks using anomaly-aware features
- Integrate ML decisions into a real SIEM (Wazuh)
- Demonstrate a live, working SOC automation pipeline

## ğŸ§  Key Contributions & Novelty

### ğŸ”¹ Hybrid Semi-Supervised Learning

- Uses Rank-based Tri-Training with only 20â€“30% labeled data
- Pseudo-labeling with confidence ranking reduces bias
- Improves recall for rare attacks compared to supervised baselines

### ğŸ”¹ Evasion-Aware Detection

- Isolation Forest anomaly score trained on benign traffic only
- Helps identify stealthy and unseen attacks

### ğŸ”¹ Real-Time SOC Integration

- ML model deployed as a REST API
- Integrated directly with Wazuh Manager
- Decisions feed back into Wazuh as new alerts

### ğŸ”¹ Live Demonstration Capability

- Synthetic SOC log generator simulates real traffic
- Logs streamed in batches to mimic real SOC behavior
- End-to-end alerts visible in Wazuh Dashboard

### ğŸ“Œ Novelty

Unlike most academic works that stop at offline evaluation, this project deploys SSL models inside a **real SIEM environment**, bridging the gap between research and production SOC operations.

## ğŸ§© System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Raw Network  â”‚
â”‚  Flow Data   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Data Preprocessing â”‚
â”‚ & Feature Engg     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Hybrid SSL Model   â”‚
â”‚(Rank Tri-Training) â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Synthetic SOC Logs â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Wazuh SIEM       â”‚
â”‚ (Log Ingestion)    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ML REST API Server â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ML-Based Triage    â”‚
â”‚(ESCALATE / CLOSE)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“‚ Repository Structure

```
soc_ai/
â”œâ”€â”€ models/
â”‚   â””â”€â”€ final_hybrid_model.joblib
â”‚
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ test_friday.parquet
â”‚   â””â”€â”€ synthetic_logs_10k.json
â”‚
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ model_server.py        # ML inference API
â”‚   â”œâ”€â”€ log_fwd.py             # Log streaming to Wazuh
â”‚   â””â”€â”€ generate_synthetic.py  # Synthetic SOC log generator
â”‚
â”œâ”€â”€ notebooks/
â”‚   â”œâ”€â”€ SOC_Preprocessing_Pipeline.ipynb
â”‚   â””â”€â”€ SOC_Hybrid_SSL_Pipeline.ipynb
â”‚
â”œâ”€â”€ wazuh/
â”‚   â””â”€â”€ local_rules.xml        # SOC automation rules
â”‚
â””â”€â”€ README.md
```

## ğŸ§ª Dataset Description

**Base Dataset:** CICIDS2017

**Label Distribution:** Highly imbalanced

**Features:** 88 numeric flow-level features

**Training Strategy:**
- 20â€“30% labeled
- 70â€“80% unlabeled
- Time-based split (Monâ€“Thu train, Fri test)

## ğŸ¤– Machine Learning Pipeline

### 1ï¸âƒ£ Preprocessing

- Column normalization
- Time-aware train/test split
- Zero data leakage enforcement

### 2ï¸âƒ£ Feature Engineering

- Stateless ratios (packet, byte ratios)
- Stateful rarity features (port rarity)
- Anomaly score using Isolation Forest

### 3ï¸âƒ£ Hybrid SSL Training

- Rank-based Tri-Training
- Confidence-weighted pseudo labeling
- Probability calibration

### 4ï¸âƒ£ Evaluation Metrics

- Recall (primary)
- Precision-Recall Curve
- Confusion Matrix
- Threshold-based decision analysis

## ğŸ“Š Visualization & Evaluation

The following plots are generated inside `SOC_Hybrid_SSL_Pipeline.ipynb`:

- Precision-Recall Curve
- Recall vs Threshold
- Supervised vs SSL Performance Comparison
- Anomaly Score Distribution
- Confusion Matrix

## ğŸ”Œ Wazuh Integration

### âœ” Log Ingestion

- Synthetic logs written to `/var/log/soc_stream.json`
- Parsed as JSON by Wazuh

### âœ” ML Integration

- ML model served via Flask API
- Wazuh forwards candidate alerts to ML endpoint

### âœ” Automated Triage

Wazuh rules detect ML decisions:

```xml
<rule id="100102" level="12">
  <field name="ml_decision">ESCALATE</field>
  <description>ML Triage: HIGH CONFIDENCE ATTACK</description>
</rule>
```

Alerts appear live in Wazuh Dashboard.

## â–¶ï¸ How to Run (Demo Mode)

### 1. Start ML Server

```bash
python3 scripts/model_server.py
```

### 2. Stream Synthetic Logs

```bash
python3 scripts/log_fwd.py
```

### 3. Open Wazuh Dashboard

Navigate to `https://<wazuh-ip>` and observe AUTO-CLOSE and ESCALATE alerts in real time.

## ğŸ Results Summary

| Model | Recall | Precision |
|-------|--------|-----------|
| Supervised Baseline | Low | High |
| Hybrid SSL Model | High | Competitive |

**Key Achievements:**
- âœ” Improved detection of rare attacks
- âœ” Reduced alert noise
- âœ” Fully operational SOC pipeline

## ğŸ“Œ Conclusion

This project demonstrates that semi-supervised learning is not only **academically effective** but **operationally deployable**. By integrating SSL with a production SIEM, the system achieves scalable, intelligent SOC automation suitable for real-world security environments.

## ğŸ“š References

- CICIDS2017 Dataset
- Wazuh Documentation
- Semi-Supervised Learning Literature
- Rank-Based Tri-Training

---

**Author:** [Your Name]  
**Last Updated:** December 2025  
**License:** [Specify License]
